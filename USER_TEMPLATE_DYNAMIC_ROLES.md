# ç”¨æˆ·å¯¼å…¥æ¨¡æ¿ - åŠ¨æ€è§’è‰²åŠŸèƒ½

## ğŸ“ åŠŸèƒ½æ¦‚è¿°

ç”¨æˆ·å¯¼å…¥æ¨¡æ¿ç°åœ¨ä¼š**åŠ¨æ€ç”Ÿæˆæ‰€æœ‰è§’è‰²çš„ç¤ºä¾‹**ï¼ˆæ’é™¤è¶…çº§ç®¡ç†å‘˜ï¼‰ï¼Œä¸å†æ˜¯å›ºå®šçš„å‡ ä¸ªè§’è‰²ç¤ºä¾‹ã€‚

**æ¥å£ï¼š** `GET /users/template`

---

## âœ… ä¿®æ”¹å†…å®¹

### ä¿®æ”¹å‰çš„æ¨¡æ¿ç¤ºä¾‹

æ¨¡æ¿å›ºå®šåŒ…å«4ä¸ªç¤ºä¾‹ï¼š
```
| é‚®ç®±                  | å§“å   | å¯†ç         | è§’è‰²       |
| --------------------- | ------ | ----------- | ---------- |
| admin@example.com     | ç®¡ç†å‘˜ | admin123    | è¶…çº§ç®¡ç†å‘˜ |
| teacher@example.com   | å¼ è€å¸ˆ | password123 | æ•™å¸ˆ       |
| assistant@example.com | æåŠ©æ•™ | password456 | åŠ©æ•™       |
| student@example.com   | ç‹åŒå­¦ | password789 | å­¦ç”Ÿ       |
```

âŒ é—®é¢˜ï¼š
- åŒ…å«è¶…çº§ç®¡ç†å‘˜ï¼ˆä¸åº”è¯¥é€šè¿‡å¯¼å…¥åˆ›å»ºï¼‰
- ç¼ºå°‘"ç®¡ç†å‘˜"ã€"æ•™å¸ˆç»„é•¿"ã€"åŠ©æ•™ç»„é•¿"è§’è‰²
- ç¤ºä¾‹ä¸å®Œæ•´

### ä¿®æ”¹åçš„æ¨¡æ¿ç¤ºä¾‹

æ¨¡æ¿åŠ¨æ€ç”Ÿæˆï¼ŒåŒ…å«æ‰€æœ‰å¯ç”¨è§’è‰²ï¼ˆé™¤è¶…çº§ç®¡ç†å‘˜ï¼‰ï¼š
```
| é‚®ç®±                    | å§“å       | å¯†ç         | è§’è‰²     |
| ----------------------- | ---------- | ----------- | -------- |
| guanliyuan1@example.com | å¼ ç®¡ç†å‘˜   | password123 | ç®¡ç†å‘˜   |
| jiaoshizuzhang2@...     | ææ•™å¸ˆç»„é•¿ | password223 | æ•™å¸ˆç»„é•¿ |
| jiaoshi3@example.com    | ç‹è€å¸ˆ     | password323 | æ•™å¸ˆ     |
| zhujiaozuzhang4@...     | èµµåŠ©æ•™ç»„é•¿ | password423 | åŠ©æ•™ç»„é•¿ |
| zhujiao5@example.com    | åˆ˜åŠ©æ•™     | password523 | åŠ©æ•™     |
| xuesheng6@example.com   | é™ˆåŒå­¦     | password623 | å­¦ç”Ÿ     |
```

âœ… ä¼˜åŠ¿ï¼š
- è‡ªåŠ¨æ’é™¤è¶…çº§ç®¡ç†å‘˜
- åŒ…å«æ‰€æœ‰ç³»ç»Ÿè§’è‰²
- åŒ…å«è‡ªå®šä¹‰è§’è‰²ï¼ˆå¦‚æœæœ‰ï¼‰
- æ¯ä¸ªè§’è‰²éƒ½æœ‰ç¤ºä¾‹

---

## ğŸ”§ å®ç°ç»†èŠ‚

### 1. ä»æ•°æ®åº“åŠ¨æ€åŠ è½½è§’è‰²

```typescript
// æŸ¥è¯¢æ‰€æœ‰è§’è‰²ï¼ˆæ’é™¤è¶…çº§ç®¡ç†å‘˜ï¼‰
const roles = await this.prisma.role.findMany({
  where: {
    isActive: true,
    name: { not: 'è¶…çº§ç®¡ç†å‘˜' }, // æ’é™¤è¶…çº§ç®¡ç†å‘˜
  },
  orderBy: { id: 'asc' },
});
```

### 2. ä¸ºæ¯ä¸ªè§’è‰²ç”Ÿæˆç¤ºä¾‹æ•°æ®

```typescript
roles.forEach((role, index) => {
  const namePrefix = nameTemplates[index % nameTemplates.length];
  const nameSuffix = nameTypes[role.name] || 'ç”¨æˆ·';
  const sampleName = `${namePrefix}${nameSuffix}`;
  const sampleEmail = `${role.name.toLowerCase().replace(/[^a-z]/g, '')}${index + 1}@example.com`;
  const samplePassword = `password${index + 1}23`;

  sampleData.push([
    sampleEmail,
    sampleName,
    samplePassword,
    role.name,
  ]);
});
```

### 3. ç¤ºä¾‹æ•°æ®ç”Ÿæˆè§„åˆ™

| è§’è‰²     | ç¤ºä¾‹é‚®ç®±                    | ç¤ºä¾‹å§“å   | ç¤ºä¾‹å¯†ç     |
| -------- | --------------------------- | ---------- | ----------- |
| ç®¡ç†å‘˜   | guanliyuan1@example.com     | å¼ ç®¡ç†å‘˜   | password123 |
| æ•™å¸ˆç»„é•¿ | jiaoshizuzhang2@example.com | ææ•™å¸ˆç»„é•¿ | password223 |
| æ•™å¸ˆ     | jiaoshi3@example.com        | ç‹è€å¸ˆ     | password323 |
| åŠ©æ•™ç»„é•¿ | zhujiaozuzhang4@example.com | èµµåŠ©æ•™ç»„é•¿ | password423 |
| åŠ©æ•™     | zhujiao5@example.com        | åˆ˜åŠ©æ•™     | password523 |
| å­¦ç”Ÿ     | xuesheng6@example.com       | é™ˆåŒå­¦     | password623 |

**è§„åˆ™è¯´æ˜ï¼š**
- é‚®ç®±ï¼šè§’è‰²æ‹¼éŸ³ + åºå· + @example.com
- å§“åï¼šå§“æ° + è§’è‰²ç±»å‹
- å¯†ç ï¼špassword + åºå· + 23

---

## ğŸ“Š æ¨¡æ¿æ ¼å¼

### Excel åˆ—å®šä¹‰

| åˆ—å | å¿…å¡« | è¯´æ˜                               | ç¤ºä¾‹                  |
| ---- | ---- | ---------------------------------- | --------------------- |
| é‚®ç®± | âœ… æ˜¯ | ç”¨æˆ·é‚®ç®±ï¼Œå¿…é¡»å”¯ä¸€                 | `teacher@example.com` |
| å§“å | âŒ å¦ | ç”¨æˆ·å§“å                           | `å¼ è€å¸ˆ`              |
| å¯†ç  | âœ… æ˜¯ | ç™»å½•å¯†ç                            | `password123`         |
| è§’è‰² | âœ… æ˜¯ | è§’è‰²åç§°ï¼ˆå¿…é¡»æ˜¯ç³»ç»Ÿä¸­å­˜åœ¨çš„è§’è‰²ï¼‰ | `æ•™å¸ˆ`                |

### æ”¯æŒçš„è§’è‰²åç§°

æ¨¡æ¿ä¸­ä¼šè‡ªåŠ¨åŒ…å«ä»¥ä¸‹è§’è‰²ï¼ˆæ ¹æ®æ•°æ®åº“å®é™…æ•°æ®ï¼‰ï¼š
- âœ… ç®¡ç†å‘˜
- âœ… æ•™å¸ˆç»„é•¿
- âœ… æ•™å¸ˆ
- âœ… åŠ©æ•™ç»„é•¿
- âœ… åŠ©æ•™
- âœ… å­¦ç”Ÿ
- âœ… ä»»ä½•è‡ªå®šä¹‰è§’è‰²

âŒ ä¸åŒ…å«ï¼š
- è¶…çº§ç®¡ç†å‘˜ï¼ˆå‡ºäºå®‰å…¨è€ƒè™‘ï¼‰

---

## ğŸš€ ä½¿ç”¨æµç¨‹

### 1. ä¸‹è½½æ¨¡æ¿

åœ¨åå°ç®¡ç†ç³»ç»Ÿä¸­ï¼š
1. ç‚¹å‡»"ç”¨æˆ·ç®¡ç†"
2. ç‚¹å‡»"ä¸‹è½½æ¨¡æ¿"æŒ‰é’®
3. ä¿å­˜ Excel æ–‡ä»¶

æˆ–é€šè¿‡ APIï¼š
```bash
curl -X GET http://localhost:3000/users/template \
  -H "Authorization: Bearer <token>" \
  --output ç”¨æˆ·å¯¼å…¥æ¨¡æ¿.xlsx
```

### 2. å¡«å†™ç”¨æˆ·æ•°æ®

æ‰“å¼€ä¸‹è½½çš„ Excel æ–‡ä»¶ï¼š
- å‚è€ƒç¤ºä¾‹è¡Œçš„æ ¼å¼
- åˆ é™¤ç¤ºä¾‹è¡Œæˆ–ä¿®æ”¹ä¸ºå®é™…æ•°æ®
- æ·»åŠ éœ€è¦å¯¼å…¥çš„ç”¨æˆ·

**ç¤ºä¾‹ï¼š**
```
| é‚®ç®±             | å§“å   | å¯†ç         | è§’è‰² |
| ---------------- | ------ | ----------- | ---- |
| zhang@school.edu | å¼ æ•™æˆ | StrongPass1 | æ•™å¸ˆ |
| li@school.edu    | æåŠ©æ•™ | StrongPass2 | åŠ©æ•™ |
| wang@school.edu  | ç‹åŒå­¦ | StrongPass3 | å­¦ç”Ÿ |
```

### 3. å¯¼å…¥ç”¨æˆ·

1. åœ¨åå°ç®¡ç†ç³»ç»Ÿç‚¹å‡»"æ‰¹é‡å¯¼å…¥"
2. é€‰æ‹©å¡«å†™å¥½çš„ Excel æ–‡ä»¶
3. ç‚¹å‡»"å¼€å§‹å¯¼å…¥"
4. æŸ¥çœ‹å¯¼å…¥ç»“æœ

---

## âš ï¸ æ³¨æ„äº‹é¡¹

### 1. è§’è‰²åç§°å¿…é¡»å‡†ç¡®

**æ­£ç¡®ï¼š**
```
è§’è‰²
------
ç®¡ç†å‘˜
æ•™å¸ˆ
å­¦ç”Ÿ
```

**é”™è¯¯ï¼š**
```
è§’è‰²
------
ç®¡ç†äººå‘˜  âŒ ï¼ˆè§’è‰²åç§°ä¸å­˜åœ¨ï¼‰
è€å¸ˆ      âŒ ï¼ˆåº”è¯¥æ˜¯"æ•™å¸ˆ"ï¼‰
STUDENT   âŒ ï¼ˆåº”è¯¥ç”¨ä¸­æ–‡"å­¦ç”Ÿ"ï¼‰
```

### 2. è¶…çº§ç®¡ç†å‘˜ä¸èƒ½é€šè¿‡å¯¼å…¥åˆ›å»º

å¦‚æœ Excel ä¸­åŒ…å«"è¶…çº§ç®¡ç†å‘˜"è§’è‰²ï¼Œå¯¼å…¥æ—¶ä¼šå¤±è´¥ã€‚

**åˆ›å»ºè¶…çº§ç®¡ç†å‘˜çš„æ­£ç¡®æ–¹æ³•ï¼š**
```bash
# é€šè¿‡åˆå§‹åŒ–è„šæœ¬
npm run seed

# æˆ–ä½¿ç”¨ä¸“ç”¨è„šæœ¬
node create-admin.js
```

### 3. é‚®ç®±å¿…é¡»å”¯ä¸€

å¦‚æœé‚®ç®±å·²å­˜åœ¨ï¼Œè¯¥è¡Œå¯¼å…¥ä¼šå¤±è´¥ï¼Œä½†ä¸å½±å“å…¶ä»–è¡Œã€‚

### 4. å¯†ç å¼ºåº¦å»ºè®®

è™½ç„¶æ¨¡æ¿ç¤ºä¾‹ä½¿ç”¨ç®€å•å¯†ç ï¼Œä½†ç”Ÿäº§ç¯å¢ƒå»ºè®®ä½¿ç”¨å¼ºå¯†ç ï¼š
- è‡³å°‘8ä½
- åŒ…å«å¤§å°å†™å­—æ¯ã€æ•°å­—ã€ç‰¹æ®Šå­—ç¬¦
- ä¾‹å¦‚ï¼š`Abc123!@#`

---

## ğŸ§ª æµ‹è¯•éªŒè¯

### æµ‹è¯• 1ï¼šéªŒè¯æ¨¡æ¿åŒ…å«æ‰€æœ‰è§’è‰²

1. ä¸‹è½½æ¨¡æ¿
2. æ‰“å¼€ Excel æ–‡ä»¶
3. æ£€æŸ¥ç¤ºä¾‹è¡Œæ˜¯å¦åŒ…å«ä»¥ä¸‹è§’è‰²ï¼š
   - âœ… ç®¡ç†å‘˜
   - âœ… æ•™å¸ˆç»„é•¿
   - âœ… æ•™å¸ˆ
   - âœ… åŠ©æ•™ç»„é•¿
   - âœ… åŠ©æ•™
   - âœ… å­¦ç”Ÿ
   - âŒ è¶…çº§ç®¡ç†å‘˜ï¼ˆä¸åº”è¯¥åŒ…å«ï¼‰

### æµ‹è¯• 2ï¼šå¯¼å…¥æ¨¡æ¿ä¸­çš„ç¤ºä¾‹æ•°æ®

1. ä¸‹è½½æ¨¡æ¿ï¼ˆä¸ä¿®æ”¹ï¼‰
2. ç›´æ¥å¯¼å…¥
3. åº”è¯¥å…¨éƒ¨å¯¼å…¥æˆåŠŸï¼ˆå¦‚æœé‚®ç®±ä¸å†²çªï¼‰

### æµ‹è¯• 3ï¼šä¿®æ”¹è§’è‰²åä¸‹è½½

1. åœ¨åå°åˆ›å»ºè‡ªå®šä¹‰è§’è‰²ï¼ˆå¦‚"è®¿å®¢"ï¼‰
2. é‡æ–°ä¸‹è½½æ¨¡æ¿
3. æ¨¡æ¿åº”è¯¥åŒ…å«æ–°åˆ›å»ºçš„è§’è‰²ç¤ºä¾‹

---

## ğŸ“‹ ç”Ÿæˆçš„ç¤ºä¾‹æ•°æ®

åŸºäº7ä¸ªç³»ç»Ÿè§’è‰²ï¼ˆæ’é™¤è¶…çº§ç®¡ç†å‘˜ï¼‰ï¼Œæ¨¡æ¿å°†åŒ…å«6è¡Œç¤ºä¾‹ï¼š

```excel
| åºå· | é‚®ç®±                        | å§“å       | å¯†ç         | è§’è‰²     |
| ---- | --------------------------- | ---------- | ----------- | -------- |
| 1    | guanliyuan1@example.com     | å¼ ç®¡ç†å‘˜   | password123 | ç®¡ç†å‘˜   |
| 2    | jiaoshizuzhang2@example.com | ææ•™å¸ˆç»„é•¿ | password223 | æ•™å¸ˆç»„é•¿ |
| 3    | jiaoshi3@example.com        | ç‹è€å¸ˆ     | password323 | æ•™å¸ˆ     |
| 4    | zhujiaozuzhang4@example.com | èµµåŠ©æ•™ç»„é•¿ | password423 | åŠ©æ•™ç»„é•¿ |
| 5    | zhujiao5@example.com        | åˆ˜åŠ©æ•™     | password523 | åŠ©æ•™     |
| 6    | xuesheng6@example.com       | é™ˆåŒå­¦     | password623 | å­¦ç”Ÿ     |
```

---

## ğŸ” æŠ€æœ¯å®ç°

### ä¿®æ”¹çš„æ–‡ä»¶

1. **`src/users/services/excel.service.ts`**
   - ä¿®æ”¹ `generateUserTemplate()` æ–¹æ³•
   - ä»åŒæ­¥æ”¹ä¸ºå¼‚æ­¥
   - ä»æ•°æ®åº“åŠ¨æ€åŠ è½½è§’è‰²
   - è‡ªåŠ¨ç”Ÿæˆç¤ºä¾‹æ•°æ®

2. **`src/users/users.controller.ts`**
   - ä¿®æ”¹ `downloadTemplate()` æ–¹æ³•
   - æ·»åŠ  `async` å…³é”®å­—
   - ä½¿ç”¨ `await` è°ƒç”¨æ¨¡æ¿ç”Ÿæˆ

### ä»£ç é€»è¾‘

```typescript
// 1. æŸ¥è¯¢æ‰€æœ‰å¯ç”¨è§’è‰²ï¼ˆæ’é™¤è¶…çº§ç®¡ç†å‘˜ï¼‰
const roles = await prisma.role.findMany({
  where: {
    isActive: true,
    name: { not: 'è¶…çº§ç®¡ç†å‘˜' }
  }
});

// 2. ä¸ºæ¯ä¸ªè§’è‰²ç”Ÿæˆç¤ºä¾‹
roles.forEach((role, index) => {
  const sampleEmail = generateEmail(role, index);
  const sampleName = generateName(role, index);
  const samplePassword = generatePassword(index);
  
  sampleData.push([sampleEmail, sampleName, samplePassword, role.name]);
});

// 3. ç”Ÿæˆ Excel
const workbook = XLSX.utils.book_new();
const worksheet = XLSX.utils.aoa_to_sheet([headers, ...sampleData]);
XLSX.utils.book_append_sheet(workbook, worksheet, 'ç”¨æˆ·å¯¼å…¥æ¨¡æ¿');
```

---

## ğŸ¯ ä¼˜åŠ¿å¯¹æ¯”

### ä¿®æ”¹å‰ï¼ˆç¡¬ç¼–ç ï¼‰
âŒ ç¤ºä¾‹å›ºå®šï¼Œä¸å¤Ÿå…¨é¢  
âŒ åŒ…å«è¶…çº§ç®¡ç†å‘˜ï¼ˆå®‰å…¨éšæ‚£ï¼‰  
âŒ ç¼ºå°‘æŸäº›è§’è‰²ç¤ºä¾‹  
âŒ æ–°å¢è§’è‰²éœ€è¦ä¿®æ”¹ä»£ç   

### ä¿®æ”¹åï¼ˆåŠ¨æ€ç”Ÿæˆï¼‰
âœ… è‡ªåŠ¨åŒ…å«æ‰€æœ‰è§’è‰²  
âœ… æ’é™¤è¶…çº§ç®¡ç†å‘˜ï¼ˆæ›´å®‰å…¨ï¼‰  
âœ… ç¤ºä¾‹å®Œæ•´ï¼Œè¦†ç›–æ‰€æœ‰è§’è‰²  
âœ… æ”¯æŒè‡ªå®šä¹‰è§’è‰²  
âœ… æ— éœ€ç»´æŠ¤ç¤ºä¾‹æ•°æ®  

---

## ğŸ”„ éƒ¨ç½²åˆ°æœåŠ¡å™¨

### æœ¬åœ°æµ‹è¯•

```bash
# 1. æ„å»ºé¡¹ç›®
npm run build

# 2. å¯åŠ¨æœåŠ¡
npm run start:dev

# 3. æµ‹è¯•ä¸‹è½½æ¨¡æ¿
curl -X GET http://localhost:3000/users/template \
  -H "Authorization: Bearer <your-token>" \
  --output test-template.xlsx

# 4. æ‰“å¼€ Excel æ–‡ä»¶éªŒè¯
```

### ç”Ÿäº§æœåŠ¡å™¨

```bash
# 1. è¿›å…¥é¡¹ç›®ç›®å½•
cd ~/apps/teaching-case-service

# 2. æ‹‰å–æœ€æ–°ä»£ç 
git pull origin main

# 3. é‡æ–°æ„å»º
npm run build

# 4. é‡å¯åº”ç”¨
pm2 restart teaching-case-service

# 5. éªŒè¯
pm2 logs teaching-case-service --lines 20
```

---

## ğŸ§ª æµ‹è¯•ç”¨ä¾‹

### æµ‹è¯•ç”¨ä¾‹ 1ï¼šåŸºç¡€åŠŸèƒ½æµ‹è¯•

```bash
# ä¸‹è½½æ¨¡æ¿
curl -X GET http://localhost:3000/users/template \
  -H "Authorization: Bearer <token>" \
  --output template.xlsx

# éªŒè¯æ–‡ä»¶å·²ä¸‹è½½
ls -lh template.xlsx

# ä½¿ç”¨å·¥å…·æŸ¥çœ‹å†…å®¹ï¼ˆå¦‚æœå®‰è£…äº† xlsx2csvï¼‰
# xlsx2csv template.xlsx
```

### æµ‹è¯•ç”¨ä¾‹ 2ï¼šéªŒè¯è§’è‰²å®Œæ•´æ€§

**é¢„æœŸç»“æœï¼š**
- âœ… åŒ…å«6ä¸ªè§’è‰²ç¤ºä¾‹ï¼ˆç®¡ç†å‘˜ã€æ•™å¸ˆç»„é•¿ã€æ•™å¸ˆã€åŠ©æ•™ç»„é•¿ã€åŠ©æ•™ã€å­¦ç”Ÿï¼‰
- âœ… ä¸åŒ…å«è¶…çº§ç®¡ç†å‘˜
- âœ… æ¯è¡Œæ•°æ®æ ¼å¼æ­£ç¡®
- âœ… åˆ—å®½é€‚ä¸­ï¼Œå†…å®¹æ¸…æ™°å¯è§

### æµ‹è¯•ç”¨ä¾‹ 3ï¼šå¯¼å…¥æµ‹è¯•

1. ä¸‹è½½æ¨¡æ¿
2. ä¿®æ”¹ç¤ºä¾‹æ•°æ®çš„é‚®ç®±ï¼ˆé¿å…é‡å¤ï¼‰
3. ç›´æ¥å¯¼å…¥
4. éªŒè¯6ä¸ªç”¨æˆ·éƒ½åˆ›å»ºæˆåŠŸ

### æµ‹è¯•ç”¨ä¾‹ 4ï¼šè‡ªå®šä¹‰è§’è‰²æµ‹è¯•

1. åˆ›å»ºè‡ªå®šä¹‰è§’è‰²ï¼ˆå¦‚"è®¿å®¢"ï¼‰
2. é‡æ–°ä¸‹è½½æ¨¡æ¿
3. éªŒè¯æ¨¡æ¿åŒ…å«æ–°è§’è‰²çš„ç¤ºä¾‹

---

## ğŸ“– ç›¸å…³æ–‡æ¡£

### ä½¿ç”¨æŒ‡å—
- [æ‰¹é‡ç”¨æˆ·å¯¼å…¥è¯´æ˜](./BATCH_USER_IMPORT_README.md)
- [è§’è‰²æƒé™ç³»ç»Ÿ](./ROLE_PERMISSION_SYSTEM_README.md)

### API æ–‡æ¡£
- Swagger: `http://localhost:3000/api`
- æ¥å£: `GET /users/template`

---

## ğŸ›¡ï¸ å®‰å…¨è€ƒè™‘

### 1. ä¸ºä»€ä¹ˆæ’é™¤è¶…çº§ç®¡ç†å‘˜ï¼Ÿ

**åŸå› ï¼š**
- è¶…çº§ç®¡ç†å‘˜æ‹¥æœ‰ç³»ç»Ÿæœ€é«˜æƒé™
- ä¸åº”è¯¥é€šè¿‡æ‰¹é‡å¯¼å…¥éšæ„åˆ›å»º
- åº”è¯¥é€šè¿‡å—æ§çš„åˆå§‹åŒ–è„šæœ¬åˆ›å»º
- é˜²æ­¢è¯¯æ“ä½œåˆ›å»ºå¤šä¸ªè¶…çº§ç®¡ç†å‘˜

**åˆ›å»ºè¶…çº§ç®¡ç†å‘˜çš„æ­£ç¡®æ–¹å¼ï¼š**
```bash
# æ–¹å¼1ï¼šåˆå§‹åŒ–è„šæœ¬
npm run seed

# æ–¹å¼2ï¼šä¸“ç”¨åˆ›å»ºè„šæœ¬
node create-admin.js

# æ–¹å¼3ï¼šæ‰‹åŠ¨æ•°æ®åº“æ“ä½œ
# ï¼ˆåœ¨ä¸¥æ ¼çš„æƒé™æ§åˆ¶ä¸‹ï¼‰
```

### 2. æ¨¡æ¿æ–‡ä»¶åç¼–ç 

ä½¿ç”¨ RFC 5987 ç¼–ç å¤„ç†ä¸­æ–‡æ–‡ä»¶åï¼š
```typescript
const filename = encodeURIComponent('ç”¨æˆ·å¯¼å…¥æ¨¡æ¿.xlsx');
res.set({
  'Content-Disposition': `attachment; filename="user-template.xlsx"; filename*=UTF-8''${filename}`
});
```

ç¡®ä¿åœ¨å„ç§æµè§ˆå™¨å’Œæ“ä½œç³»ç»Ÿä¸Šéƒ½èƒ½æ­£ç¡®æ˜¾ç¤ºä¸­æ–‡æ–‡ä»¶åã€‚

---

## ğŸ’¡ ä½¿ç”¨æŠ€å·§

### æŠ€å·§ 1ï¼šæ‰¹é‡åˆ›å»ºåŒä¸€è§’è‰²

å¦‚æœéœ€è¦æ‰¹é‡åˆ›å»ºæŸä¸€è§’è‰²çš„ç”¨æˆ·ï¼ˆå¦‚æ‰¹é‡åˆ›å»ºå­¦ç”Ÿï¼‰ï¼š

1. ä¸‹è½½æ¨¡æ¿
2. åˆ é™¤å…¶ä»–è§’è‰²çš„ç¤ºä¾‹è¡Œ
3. å¤åˆ¶"å­¦ç”Ÿ"ç¤ºä¾‹è¡Œå¤šæ¬¡
4. ä¿®æ”¹æ¯è¡Œçš„é‚®ç®±ã€å§“åã€å¯†ç 
5. å¯¼å…¥

### æŠ€å·§ 2ï¼šå¯¼å…¥åé‡ç½®å¯†ç 

å»ºè®®å¯¼å…¥åæé†’ç”¨æˆ·ä¿®æ”¹å¯†ç ï¼š

```typescript
// åˆ›å»ºç”¨æˆ·æ—¶å‘é€é‚®ä»¶é€šçŸ¥
await sendEmail(user.email, {
  subject: 'è´¦å·å·²åˆ›å»º',
  content: 'æ‚¨çš„è´¦å·å·²åˆ›å»ºï¼Œè¯·ç™»å½•åç«‹å³ä¿®æ”¹å¯†ç '
});
```

### æŠ€å·§ 3ï¼šé¢„è§ˆå¯¼å…¥æ•°æ®

å¯¼å…¥å‰å¯ä»¥å…ˆé¢„è§ˆï¼š
1. é€‰æ‹© Excel æ–‡ä»¶
2. ç³»ç»Ÿæ˜¾ç¤ºå°†è¦å¯¼å…¥çš„ç”¨æˆ·åˆ—è¡¨
3. ç¡®è®¤æ— è¯¯åå†æ‰§è¡Œå¯¼å…¥

---

## ğŸ”® æœªæ¥æ‰©å±•

### 1. æ¨¡æ¿è¯´æ˜é¡µ

åœ¨ Excel ä¸­æ·»åŠ ç¬¬äºŒä¸ªå·¥ä½œè¡¨"ä½¿ç”¨è¯´æ˜"ï¼š

```typescript
const instructions = [
  ['ç”¨æˆ·æ‰¹é‡å¯¼å…¥è¯´æ˜'],
  [''],
  ['1. å¡«å†™è¯´æ˜ï¼š'],
  ['   - é‚®ç®±ï¼šå¿…å¡«ï¼Œéœ€è¦å”¯ä¸€'],
  ['   - å§“åï¼šé€‰å¡«'],
  ['   - å¯†ç ï¼šå¿…å¡«ï¼Œå»ºè®®ä½¿ç”¨å¼ºå¯†ç '],
  ['   - è§’è‰²ï¼šå¿…å¡«ï¼Œåªèƒ½å¡«å†™ä»¥ä¸‹è§’è‰²ä¹‹ä¸€ï¼š'],
  ...roles.map(r => [`     â€¢ ${r.name}`]),
  [''],
  ['2. æ³¨æ„äº‹é¡¹ï¼š'],
  ['   - è¯·å‹¿ä¿®æ”¹æ ‡é¢˜è¡Œ'],
  ['   - é‚®ç®±æ ¼å¼å¿…é¡»æ­£ç¡®'],
  ['   - è§’è‰²åç§°å¿…é¡»å®Œå…¨åŒ¹é…'],
];

XLSX.utils.book_append_sheet(workbook, instructionSheet, 'ä½¿ç”¨è¯´æ˜');
```

### 2. æ•°æ®éªŒè¯

æ·»åŠ  Excel å•å…ƒæ ¼éªŒè¯ï¼š
- é‚®ç®±æ ¼å¼éªŒè¯
- è§’è‰²ä¸‹æ‹‰åˆ—è¡¨é€‰æ‹©
- å¯†ç é•¿åº¦é™åˆ¶

### 3. æ¨¡æ¿ç‰ˆæœ¬ç®¡ç†

åœ¨æ¨¡æ¿ä¸­æ·»åŠ ç‰ˆæœ¬ä¿¡æ¯ï¼š
```typescript
const versionInfo = [
  ['æ¨¡æ¿ç‰ˆæœ¬ï¼š', '2.0'],
  ['ç”Ÿæˆæ—¶é—´ï¼š', new Date().toLocaleString('zh-CN')],
  ['è§’è‰²æ•°é‡ï¼š', roles.length],
];
```

---

## ğŸ“ æ›´æ–°æ—¥å¿—

### v2.0 - 2025-10-13
- âœ… æ”¹ä¸ºåŠ¨æ€ç”Ÿæˆæ¨¡æ¿
- âœ… è‡ªåŠ¨åŒ…å«æ‰€æœ‰è§’è‰²ï¼ˆé™¤è¶…çº§ç®¡ç†å‘˜ï¼‰
- âœ… æ”¯æŒè‡ªå®šä¹‰è§’è‰²
- âœ… ä¼˜åŒ–ç¤ºä¾‹æ•°æ®ç”Ÿæˆé€»è¾‘
- âœ… å¢åŠ åˆ—å®½ä»¥å®¹çº³é•¿è§’è‰²å

### v1.0 - åŸå§‹ç‰ˆæœ¬
- å›ºå®š4ä¸ªè§’è‰²ç¤ºä¾‹
- åŒ…å«è¶…çº§ç®¡ç†å‘˜

---

*ç”¨æˆ·å¯¼å…¥æ¨¡æ¿åŠ¨æ€è§’è‰²åŠŸèƒ½ - v2.0*

