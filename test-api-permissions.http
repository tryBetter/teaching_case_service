### API 权限测试脚本
### 测试不同角色用户对接口的访问权限

@baseUrl = http://localhost:3000
@adminToken = 
@teacherToken = 
@assistantToken = 
@studentToken = 

### ==================== 1. 获取测试用户的 Token ====================

### 1.1 管理员登录
POST {{baseUrl}}/admin/auth/login
Content-Type: application/json

{
  "email": "admin@test.com",
  "password": "123456"
}

### 1.2 教师登录
POST {{baseUrl}}/auth/login
Content-Type: application/json

{
  "email": "999@test.com",
  "password": "123456"
}

### 1.3 助教登录（如果有）
POST {{baseUrl}}/auth/login
Content-Type: application/json

{
  "email": "assistant@test.com",
  "password": "123456"
}

### ==================== 2. 用户管理接口测试 ====================

### 2.1 获取用户列表（普通接口，需要登录）
GET {{baseUrl}}/users
Authorization: Bearer {{teacherToken}}

### 2.2 获取角色列表（管理员专用）- 使用教师token（应该403）
GET {{baseUrl}}/users/roles
Authorization: Bearer {{teacherToken}}

### 2.3 获取角色列表（管理员专用）- 使用管理员token（应该200）
GET {{baseUrl}}/users/roles
Authorization: Bearer {{adminToken}}

### 2.4 获取用户统计（管理员专用）- 使用教师token（应该403）
GET {{baseUrl}}/users/stats
Authorization: Bearer {{teacherToken}}

### 2.5 获取用户统计（管理员专用）- 使用管理员token（应该200）
GET {{baseUrl}}/users/stats
Authorization: Bearer {{adminToken}}

### ==================== 3. 文章管理接口测试 ====================

### 3.1 获取文章列表（公开接口）
GET {{baseUrl}}/articles

### 3.2 创建文章（需要教师权限）- 使用教师token（应该201）
POST {{baseUrl}}/articles
Content-Type: application/json
Authorization: Bearer {{teacherToken}}

{
  "title": "测试文章",
  "content": "测试内容",
  "summary": "测试摘要",
  "categoryId": 1,
  "published": false
}

### 3.3 获取已删除文章列表（管理员专用）- 使用教师token（应该403）
GET {{baseUrl}}/articles/deleted
Authorization: Bearer {{teacherToken}}

### 3.4 获取已删除文章列表（管理员专用）- 使用管理员token（应该200）
GET {{baseUrl}}/articles/deleted
Authorization: Bearer {{adminToken}}

### 3.5 发布文章（管理员专用）- 使用教师token（应该403）
POST {{baseUrl}}/articles/1/publish
Authorization: Bearer {{teacherToken}}

### 3.6 发布文章（管理员专用）- 使用管理员token（应该200）
POST {{baseUrl}}/articles/1/publish
Authorization: Bearer {{adminToken}}

### 3.7 获取文章统计（管理员专用）- 使用教师token（应该403）
GET {{baseUrl}}/articles/stats
Authorization: Bearer {{teacherToken}}

### 3.8 获取文章统计（管理员专用）- 使用管理员token（应该200）
GET {{baseUrl}}/articles/stats
Authorization: Bearer {{adminToken}}

### ==================== 4. 媒体管理接口测试 ====================

### 4.1 获取媒体列表（需要登录）- 使用教师token
GET {{baseUrl}}/media?userId=2
Authorization: Bearer {{teacherToken}}

### 4.2 批量删除媒体（管理员专用）- 使用教师token（应该403）
DELETE {{baseUrl}}/media/batch?ids=1,2
Authorization: Bearer {{teacherToken}}

### 4.3 批量删除媒体（管理员专用）- 使用管理员token（应该200）
DELETE {{baseUrl}}/media/batch?ids=999,998
Authorization: Bearer {{adminToken}}

### 4.4 获取媒体统计（管理员专用）- 使用教师token（应该403）
GET {{baseUrl}}/media/stats/overview
Authorization: Bearer {{teacherToken}}

### 4.5 获取媒体统计（管理员专用）- 使用管理员token（应该200）
GET {{baseUrl}}/media/stats/overview
Authorization: Bearer {{adminToken}}

### 4.6 获取媒体类型分布（管理员专用）- 使用教师token（应该403）
GET {{baseUrl}}/media/stats/distribution
Authorization: Bearer {{teacherToken}}

### 4.7 获取媒体类型分布（管理员专用）- 使用管理员token（应该200）
GET {{baseUrl}}/media/stats/distribution
Authorization: Bearer {{adminToken}}

### 4.8 获取最近上传（管理员专用）- 使用教师token（应该403）
GET {{baseUrl}}/media/recent
Authorization: Bearer {{teacherToken}}

### 4.9 获取最近上传（管理员专用）- 使用管理员token（应该200）
GET {{baseUrl}}/media/recent
Authorization: Bearer {{adminToken}}

### ==================== 5. 后台专属接口测试 ====================

### 5.1 访问后台管理界面（需要管理员登录）
GET {{baseUrl}}/admin
Authorization: Bearer {{adminToken}}

### 5.2 获取所有角色（管理员专用）- 使用教师token（应该403）
GET {{baseUrl}}/admin/roles
Authorization: Bearer {{teacherToken}}

### 5.3 获取所有角色（管理员专用）- 使用管理员token（应该200）
GET {{baseUrl}}/admin/roles
Authorization: Bearer {{adminToken}}

### 5.4 获取系统统计（管理员专用）- 使用教师token（应该403）
GET {{baseUrl}}/admin/stats/overview
Authorization: Bearer {{teacherToken}}

### 5.5 获取系统统计（管理员专用）- 使用管理员token（应该200）
GET {{baseUrl}}/admin/stats/overview
Authorization: Bearer {{adminToken}}

### ==================== 6. 公开接口测试 ====================

### 6.1 获取文章列表（无需token）
GET {{baseUrl}}/articles

### 6.2 获取分类列表（无需token）
GET {{baseUrl}}/categories

### 6.3 获取文章详情（无需token）
GET {{baseUrl}}/articles/1

### ==================== 7. 需要特定权限的接口测试 ====================

### 7.1 创建用户（需要教师权限）- 使用教师token
POST {{baseUrl}}/users
Content-Type: application/json
Authorization: Bearer {{teacherToken}}

{
  "email": "testuser@test.com",
  "password": "123456",
  "name": "测试用户",
  "roleId": 4
}

### 7.2 批量创建用户（需要教师权限）- 使用教师token
POST {{baseUrl}}/users/batch
Content-Type: multipart/form-data; boundary=----WebKitFormBoundary
Authorization: Bearer {{teacherToken}}

------WebKitFormBoundary
Content-Disposition: form-data; name="file"; filename="users.xlsx"
Content-Type: application/vnd.openxmlformats-officedocument.spreadsheetml.sheet

(binary content)
------WebKitFormBoundary--

### 7.3 上传媒体（需要教师权限）- 使用教师token
POST {{baseUrl}}/media/upload
Content-Type: multipart/form-data; boundary=----WebKitFormBoundary
Authorization: Bearer {{teacherToken}}

------WebKitFormBoundary
Content-Disposition: form-data; name="file"; filename="test.jpg"
Content-Type: image/jpeg

(binary content)
------WebKitFormBoundary--

### ==================== 测试完成 ====================

